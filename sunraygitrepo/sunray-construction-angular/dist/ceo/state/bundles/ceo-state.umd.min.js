!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs/operators"),require("rxjs"),require("lodash"),require("@angular/core"),require("@ngrx/store"),require("@ngrx/effects"),require("@ngrx/router-store")):"function"==typeof define&&define.amd?define("@ceo/state",["exports","rxjs/operators","rxjs","lodash","@angular/core","@ngrx/store","@ngrx/effects","@ngrx/router-store"],e):e((t.ceo=t.ceo||{},t.ceo.state={}),t.rxjs.operators,t.rxjs,t._,t.ng.core,t.store,t.effects,t.routerStore)}(this,function(t,r,n,p,e,o,i,a){"use strict";var c=function(t){this.payload=t},u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function s(t,e){function r(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var f=function(){return(f=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function l(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;0<=c;c--)(o=t[c])&&(a=(i<3?o(a):3<i?o(e,r,a):o(e,r))||a);return 3<i&&a&&Object.defineProperty(e,r,a),a}function y(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function d(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(n=i.next()).done;)a.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}var C={};function h(t){if(C[t])throw new Error('Action type "'+t+'" is not unique"');return C[t]=!0,t}var A={};function S(t,e){return A[t]&&A[t][e]||(A[t]=A[t]||{},A[t][e]="["+t+"] "+e,h(A[t][e])),A[t][e]}var E={INIT:"INIT",INITIALIZED:"INITIALIZED",LOAD:"LOAD",LOAD_FAIL:"LOAD_FAIL",LOAD_SUCCESS:"LOAD_SUCCESS",PATCH:"PATCH",UPDATE:"UPDATE",UPDATE_SUCCESS:"UPDATE_SUCCESS"},g=function(n){function t(t,e){var r=n.call(this,e)||this;return r.slice=t,r.payload=e,r.actionName="",r}return s(t,n),Object.defineProperty(t.prototype,"type",{get:function(){return S(this.slice,this.actionName)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"verb",{get:function(){return this.actionName},enumerable:!0,configurable:!0}),t}(c),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actionName=E.INIT,t}return s(t,e),t}(g),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actionName=E.INITIALIZED,t}return s(t,e),t}(g),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actionName=E.LOAD_FAIL,t}return s(t,e),t}(g),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.actionName=E.LOAD_SUCCESS,t}return s(t,e),t}(g),R=function(o){function t(t,e,r){var n=o.call(this,t,{path:e,val:r})||this;return n.slice=t,n.actionName=E.PATCH,n}return s(t,o),t}(g),_=function(o){function t(t,e,r){var n=o.call(this,t,{path:e,val:r})||this;return n.slice=t,n.actionName=E.UPDATE,n}return s(t,o),t}(g);function N(t,e,r){var n=[t],o=!r,i=e.payload.path,a=i&&i.length?i.length:0,c=i[i.length-1],u={},s=a;"object"==typeof e.payload.val?u=e.payload.val:("function"==typeof e.payload.val?u[c]=e.payload.val(t):u[c]=e.payload.val,s--,o=!0);var l=0;for(l=0;l<s;l++)n[l+1]=n[l][i[l]];for(o&&(u=p.merge({},n[s],u)),(n=[])[s]=u,l=s-1;0<=l;l--)n[l]={},n[l][i[l]]=n[l+1];return f({},t,n[0])}var P=function(){function t(t){var e=this;this.actions$=t,this.log$=this.actions$.pipe(r.tap(function(t){return e.log(t)}))}return t.prototype.log=function(t,e){void 0===e&&(e=!1),e&&console.log(t)},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:i.Actions}]},l([i.Effect({dispatch:!1}),y("design:type",n.Observable)],t.prototype,"log$",void 0),t}(),b=[P],j=[],L={ROUTER_NAVIGATION:"ROUTER_NAVIGATION",LAUNCH:"[ApplicationConfig] LAUNCH",LOAD_RESOURCE_BY_ID:"[ApplicationConfig] LOAD_RESOURCE_BY_ID",SET_PRIMARY_ENTITY:"[ApplicationConfig] SET_PRIMARY_ENTITY",SET_RESOURCE_TYPE:"[ApplicationConfig] SET_RESOURCE_TYPE"},U=function(){this.type=L.ROUTER_NAVIGATION},D=function(){this.type=L.LAUNCH},x=function(){this.type=L.LOAD_RESOURCE_BY_ID},Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=L.SET_PRIMARY_ENTITY,t}return s(t,e),t}(c),M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=L.SET_RESOURCE_TYPE,t}return s(t,e),t}(c),q=Object.freeze({ApplicationConfigActionTypes:L,RouterNavigation:U,Launch:D,LoadResourceById:x,SetPrimaryEntity:Y,SetResourceType:M}),$={route:{},launched:!1,resourceType:null,primaryEntity:null},w=function(){function t(t,e){this.store=t,this.actions$=e,this.init$=n.defer(function(){})}return t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:o.Store},{type:i.Actions}]},l([i.Effect(),y("design:type",n.Observable)],t.prototype,"init$",void 0),t}();function F(t,e){var r={};switch(e.type){case"ROUTER_NAVIGATION":return r={route:e.payload.routerState},p.assign({},t,r);case L.LAUNCH:return r={launched:!0},p.assign({},t,r);case L.SET_PRIMARY_ENTITY:return r={primaryEntity:e.payload},p.assign({},t,r);case L.SET_RESOURCE_TYPE:return r={resourceType:e.payload},p.assign({},t,r);default:return t}}var V=o.createFeatureSelector("router"),H=o.createSelector(V,function(t){return t&&t.state?t.state:null}),z=o.createSelector(H,function(t){return t?p.get(t,"params.id"):null}),B={selectState:H,selectRouteParamId:z},G=function(){function t(){}return t.prototype.serialize=function(t){for(var e=t.root,r={};e.firstChild;)Object.assign(r,e.params),e=e.firstChild;Object.assign(r,e.params);var n=p.get(t,"root.children[0]._urlSegment.segments");return{url:t.url,params:r,segments:n,queryParams:t.root.queryParams}},t.decorators=[{type:e.Injectable}],t}(),Z=o.createFeatureSelector("applicationConfig"),K=o.createSelector(Z,function(t){return t.launched}),k=o.createSelector(Z,function(t){return t.resourceType}),J=o.createSelector(k,B.selectRouteParamId,function(t,e){var r={id:e};return Object.assign({},t,r)}),Q=o.createSelector(Z,function(t){return t.primaryEntity}),W={launched:K,resourceType:k,resourceById:J,primaryEntity:Q},X={ACTIVATE_COMPONENT:"[SystemComponents] ACTIVATE_COMPONENT"},tt=function(){this.type=X.ACTIVATE_COMPONENT},et=Object.freeze({SystemComponentsActionTypes:X,ActivateComponent:tt}),rt={activeComponents:[]},nt=function(){function t(t,e){this.store=t,this.actions$=e,this.activateComponent$=n.defer(function(){})}return t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:o.Store},{type:i.Actions}]},l([i.Effect(),y("design:type",n.Observable)],t.prototype,"activateComponent$",void 0),t}();function ot(t,e){var r={};switch(e.type){case"[SystemComponents] ACTIVATE_COMPONENT":var n=t.activeComponents,o=p.reduce(n,function(t,e){return t.push(e),t},[]);return o.push(e.payload),r={activeComponents:o},p.assign({},t,r);default:return t}}var it=o.createFeatureSelector("systemComponents"),at=o.createSelector(it,function(t){return t.activeComponents}),ct={slice:it,activeComponents:at},ut={applicationConfig:$,systemComponents:rt},st={applicationConfig:F,systemComponents:ot,router:a.routerReducer},lt=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[o.StoreModule.forRoot(st,{initialState:ut}),i.EffectsModule.forRoot(m(b,[w,nt])),a.StoreRouterConnectingModule.forRoot({stateKey:"router"})],declarations:[],providers:m(j,[{provide:a.RouterStateSerializer,useClass:G}])}]}],t}();t.PayloadAction=c,t.sliceActions=E,t.SliceAction=g,t.Init=v,t.Initialized=T,t.LoadFail=I,t.LoadSuccess=O,t.Patch=R,t.Update=_,t.load=function(t,e){return p.merge({},t,{hasError:!1})},t.loadFail=function(t,e){return p.merge({},t,{hasError:!0})},t.loadSuccess=function(t,e){return p.merge({},t,e.payload,{hasError:!1})},t.update=function(t,e){return N(t,e,!0)},t.patch=function(t,e){return N(t,e,!1)},t.type=h,t.typeFor=S,t.effects=b,t.services=j,t.ApplicationConfigActions=q,t.applicationConfigInitialState=$,t.ApplicationConfigEffects=w,t.applicationConfigReducer=F,t.selectApplicationConfig=Z,t.selectApplicationConfigLaunched=K,t.selectApplicationConfigResourceType=k,t.selectApplicationConfigResourceById=J,t.selectApplicationConfigPrimaryEntity=Q,t.applicationConfigSelectors=W,t.routerInitialState={state:null,navigationId:null},t.selectRouter=V,t.selectRouterState=H,t.selectRouteParamId=z,t.routerSelectors=B,t.RouterCustomSerializer=G,t.SystemComponentsActions=et,t.systemComponentsInitialState=rt,t.SystemComponentsEffects=nt,t.systemComponentsReducer=ot,t.selectSystemComponents=it,t.selectSystemComponentsActiveComponents=at,t.systemComponentsSelectors=ct,t.propertySelector=function(){return!0},t.StateModule=lt,t.ɵa=P,t.ɵb=B,t.ɵc=ut,t.ɵd=st,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ceo-state.umd.min.js.map