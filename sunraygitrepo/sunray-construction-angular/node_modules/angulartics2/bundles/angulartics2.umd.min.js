!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("tslib"),require("rxjs/operators"),require("@angular/common"),require("@angular/router")):"function"==typeof define&&define.amd?define("angulartics2",["exports","@angular/core","rxjs","tslib","rxjs/operators","@angular/common","@angular/router"],t):t(e.angulartics2={},e.ng.core,e.rxjs,e.tslib,e.Rx.Observable.prototype,e.ng.common,e.ng.router)}(this,function(e,t,a,o,n,r,i){"use strict";var s=function(){this.pageTracking={autoTrackVirtualPages:!0,basePath:"",excludedRoutes:[],clearIds:!1,clearHash:!1,clearQueryParams:!1,idsRegExp:/^\d+$|^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/},this.developerMode=!1,this.ga={},this.appInsights={},this.gtm={}},c=new t.InjectionToken("ANGULARTICS2"),u=function(){function e(){}return e.prototype.trackLocation=function(e){return new a.BehaviorSubject({url:"/"})},e.prototype.prepareExternalUrl=function(e){return e},e}(),l=function(){function e(e,t){var r=this;this.tracker=e,this.pageTrack=new a.ReplaySubject(10),this.eventTrack=new a.ReplaySubject(10),this.exceptionTrack=new a.ReplaySubject(10),this.setAlias=new a.ReplaySubject(10),this.setUsername=new a.ReplaySubject(10),this.setUserProperties=new a.ReplaySubject(10),this.setUserPropertiesOnce=new a.ReplaySubject(10),this.setSuperProperties=new a.ReplaySubject(10),this.setSuperPropertiesOnce=new a.ReplaySubject(10),this.userTimings=new a.ReplaySubject(10);var n=new s;this.settings=Object.assign({},n,t.settings),this.settings.pageTracking=Object.assign({},n.pageTracking,t.settings.pageTracking),this.tracker.trackLocation(this.settings).subscribe(function(e){return r.trackUrlChange(e.url)})}return e.prototype.filterDeveloperMode=function(){var r=this;return n.filter(function(e,t){return!r.settings.developerMode})},e.prototype.trackUrlChange=function(e){if(this.settings.pageTracking.autoTrackVirtualPages&&!this.matchesExcludedRoute(e)){var t=this.clearUrl(e),r=void 0;r=this.settings.pageTracking.basePath.length?this.settings.pageTracking.basePath+t:this.tracker.prepareExternalUrl(t),this.pageTrack.next({path:r})}},e.prototype.matchesExcludedRoute=function(e){try{for(var t=o.__values(this.settings.pageTracking.excludedRoutes),r=t.next();!r.done;r=t.next()){var n=r.value;if(n instanceof RegExp&&n.test(e)||-1!==e.indexOf(n))return!0}}catch(s){a={error:s}}finally{try{r&&!r.done&&(i=t["return"])&&i.call(t)}finally{if(a)throw a.error}}return!1;var a,i},e.prototype.clearUrl=function(e){var t=this;return this.settings.pageTracking.clearIds||this.settings.pageTracking.clearQueryParams||this.settings.pageTracking.clearHash?e.split("/").map(function(e){return t.settings.pageTracking.clearQueryParams?e.split("?")[0]:e}).map(function(e){return t.settings.pageTracking.clearHash?e.split("#")[0]:e}).filter(function(e){return!t.settings.pageTracking.clearIds||!e.match(t.settings.pageTracking.idsRegExp)}).join("/"):e},e}();l.decorators=[{type:t.Injectable}],l.ctorParameters=function(){return[{type:u},{type:undefined,decorators:[{type:t.Inject,args:[c]}]}]};var p=function(){function e(e,t){this.router=e,this.location=t}return e.prototype.trackLocation=function(e){return this.router.events.pipe(n.filter(function(e){return e instanceof i.NavigationEnd}),n.filter(function(){return!e.developerMode}),n.map(function(e){return{url:e.urlAfterRedirects}}),n.delay(0))},e.prototype.prepareExternalUrl=function(e){return this.location.prepareExternalUrl(e)},e}();p.decorators=[{type:t.Injectable}],p.ctorParameters=function(){return[{type:i.Router},{type:r.Location}]};var g=function(){function e(e,t,r){this.elRef=e,this.angulartics2=t,this.renderer=r,this.angularticsProperties={}}return e.prototype.ngAfterContentInit=function(){var t=this;this.renderer.listen(this.elRef.nativeElement,this.angulartics2On||"click",function(e){return t.eventTrack(e)})},e.prototype.eventTrack=function(e){var t=this.angularticsAction,r=Object.assign({},this.angularticsProperties,{eventType:e.type});this.angularticsCategory&&(r.category=this.angularticsCategory),this.angularticsLabel&&(r.label=this.angularticsLabel),this.angularticsValue&&(r.value=this.angularticsValue),this.angulartics2.eventTrack.next({action:t,properties:r})},e}();g.decorators=[{type:t.Injectable},{type:t.Directive,args:[{selector:"[angulartics2On]"}]}],g.ctorParameters=function(){return[{type:t.ElementRef},{type:l},{type:t.Renderer2}]},g.propDecorators={angulartics2On:[{type:t.Input,args:["angulartics2On"]}],angularticsAction:[{type:t.Input}],angularticsCategory:[{type:t.Input}],angularticsLabel:[{type:t.Input}],angularticsValue:[{type:t.Input}],angularticsProperties:[{type:t.Input}]};var f=function(){};f.decorators=[{type:t.NgModule,args:[{declarations:[g],exports:[g]}]}];var h=function(){function r(){}return r.forRoot=function(e,t){return void 0===t&&(t={}),{ngModule:r,providers:o.__spread([{provide:c,useValue:{providers:e,settings:t}},l,{provide:u,useClass:p}],e)}},r}();h.decorators=[{type:t.NgModule,args:[{imports:[f],exports:[g]}]}],e.Angulartics2=l,e.Angulartics2Module=h,e.ANGULARTICS2_TOKEN=c,e.Angulartics2On=g,e.Angulartics2OnModule=f,e.RouterlessTracking=u,e.AngularRouterTracking=p,e.DefaultConfig=s,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angulartics2.umd.min.js.map
